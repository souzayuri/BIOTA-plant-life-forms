rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3)
data.biota.rich.liana
View(data.biota.rich.liana)
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment)
data.biota.rich.liana
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site)
data.biota.rich.liana
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment)
data.biota.rich.liana
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment, richness)
data.biota.rich.liana
data.biota.abu.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, life_form) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment, abundances)
data.biota.abu.liana
data.biota.abu.rich.liana <-left_join(data.biota.rich.liana, data.biota.abu.liana) %>%
select(1,4,8,5,6,7,2,9) %>%
mutate(site = as.factor(site),
treatment = as.factor(treatment),
month = as.factor(month)) %>%
rename(lianas.rich = richness,
lianas.abun = abundances)
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site)
data.biota.rich.liana
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
select(-c(3))
data.biota.rich.liana
data.biota.abu.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, life_form) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment, abundances)
data.biota.abu.liana
data.biota.abu.rich.liana <-left_join(data.biota.rich.liana, data.biota.abu.liana) %>%
select(1,4,8,5,6,7,2,9) %>%
mutate(site = as.factor(site),
treatment = as.factor(treatment),
month = as.factor(month)) %>%
rename(lianas.rich = richness,
lianas.abun = abundances)
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
select(-c(3))
data.biota.rich.liana
data.biota.abu.rich.liana <-left_join(data.biota.rich.liana, data.biota.abu.liana)
data.biota.abu.rich.liana
data.biota.rich.liana
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
select(-c(3))
data.biota.rich.liana
data.biota.rich.palm <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "palm") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("palms")) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3)
data.biota.rich.palm
data.biota.abu.palm <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "palm") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, life_form) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment, abundances)
data.biota.abu.palm
data.biota.abu.rich.palm <-left_join(data.biota.rich.palm, data.biota.abu.palm) %>%
select(1,4,8,5,6,7,2,9) %>%
mutate(site = as.factor(site),
treatment = as.factor(treatment),
month = as.factor(month)) %>%
rename(palms.rich = richness,
palms.abun = abundances)
data.biota.abu.rich.palm
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3)
data.biota.rich.liana
data.biota.abu.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, life_form) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment, abundances)
data.biota.abu.liana
bt.spc.mtz <- data_biota %>%
rename(life_form = `Life Form`) %>%
filter(!life_form == "indeterminate", !life_form == "arborescent fern") %>%
dplyr::select(-c(4, 24:26,28)) %>%
gather(key = "Month", value = "value", 4:22) %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
mutate(site=Site, treatment = Treatment, plot = Plot, month = Month, time = Time, lifeform = life_form) %>%
unite(Site, Site, Treatment, Plot, Month, Time, life_form) %>% rename(PlotID = Site) %>%
dplyr::group_by(PlotID, site, treatment, plot, month, time, Species) %>%
summarise(abundances = sum(value)) %>%
ungroup(PlotID, site, treatment, plot, month, time, species) %>%
spread(Species, abundances) %>%
replace(is.na(.), 0) %>%
remove_rownames %>%
dplyr::select(-c(2:6)) %>%
column_to_rownames(var="PlotID") %>%
hillR::hill_taxa(q = 2, MARGIN = 1) %>%
as.data.frame() %>% rownames_to_column(var="PlotID") %>%
separate(PlotID, c("Site", "Treatment", "Plot", "Month", "Time", "Life_form"), convert = TRUE) %>%
rename(simp.inv.div = ".") %>%
hablar::rationalize() %>%
spread(Life_form, simp.inv.div) %>%
mutate_all(replace_na, 0) %>%
hablar::rationalize() %>%
mutate_all(replace_na, 0) %>%
mutate(Month = as.factor(Month)) %>%
mutate(Treatment = as.factor(Treatment)) %>%
mutate(Treatment = fct_relevel(Treatment, c("open", "closed"))) %>%
mutate(site = Site,
treatment = Treatment,
plot = Plot,
month = Month,
time = Time) %>%
unite(site, site, treatment, plot, month, time) %>% rename(PlotID = site)
data_biota <- read_csv("C:/Users/Yuri/Google Drive/Yuri/Mestrado/parcelas_biota/projeto/PPG/tese/analises/01_dados/padrao/life_form_yuri_2020v1.csv") # If all the columns is imported as agregated, try to load with read_csv2 function
glimpse(data_biota)
View(data_biota)
bt.spc.mtz <- data_biota %>%
rename(life_form = `Life Form`) %>%
filter(!life_form == "indeterminate", !life_form == "arborescent fern") %>%
dplyr::select(-c(4, 24:26,28)) %>%
gather(key = "Month", value = "value", 4:22) %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
mutate(site=Site, treatment = Treatment, plot = Plot, month = Month, time = Time, lifeform = life_form) %>%
unite(Site, Site, Treatment, Plot, Month, Time, life_form) %>% rename(PlotID = Site) %>%
dplyr::group_by(PlotID, site, treatment, plot, month, time, Species) %>%
summarise(abundances = sum(value)) %>%
ungroup(PlotID, site, treatment, plot, month, time, species) %>%
spread(Species, abundances) %>%
replace(is.na(.), 0) %>%
remove_rownames %>%
dplyr::select(-c(2:6)) %>%
column_to_rownames(var="PlotID") %>%
hillR::hill_taxa(q = 2, MARGIN = 1) %>%
as.data.frame() %>% rownames_to_column(var="PlotID") %>%
separate(PlotID, c("Site", "Treatment", "Plot", "Month", "Time", "Life_form"), convert = TRUE) %>%
rename(simp.inv.div = ".") %>%
hablar::rationalize() %>%
spread(Life_form, simp.inv.div) %>%
mutate_all(replace_na, 0) %>%
hablar::rationalize() %>%
mutate_all(replace_na, 0) %>%
mutate(Month = as.factor(Month)) %>%
mutate(Treatment = as.factor(Treatment)) %>%
mutate(Treatment = fct_relevel(Treatment, c("open", "closed"))) %>%
mutate(site = Site,
treatment = Treatment,
plot = Plot,
month = Month,
time = Time) %>%
unite(site, site, treatment, plot, month, time) %>% rename(PlotID = site)
bt.spc.mtz
View(bt.spc.mtz)
data.biota.rich.tree <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "tree") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("trees")) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3)
data.biota.rich.tree
data.biota.abu.tree <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "tree") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, life_form) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%
dplyr::mutate(site = Site, plot = Plot, month = Month,
time = Time, treatment = Treatment) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(PlotID, site, plot, month,
time, treatment, abundances)
data.biota.abu.tree
data.biota.abu.rich.tree <-left_join(data.biota.rich.tree, data.biota.abu.tree) %>%
select(1,4,8,5,6,7,2,9) %>%
mutate(site = as.factor(site),
treatment = as.factor(treatment),
month = as.factor(month)) %>%
rename(trees.rich = richness,
trees.abun = abundances)
data.biota.abu.rich.tree
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) %>%
dplyr::group_by(Site, Plot, Treatment, Month, Time, Species) %>% # create a group that will be used to calculate species abundances
summarise(abundances = sum(value)) %>%  # create a 'abundances' column of each individual grouped by Site, Plot, Treatment and Month
dplyr::mutate(Species = Species %>%
stringr::str_replace(" cf. ", "..")) %>% # this function substitute " cf. " for " " between Genus and species names.
dplyr::mutate(Species = Species %>%
stringr::str_replace(" ", ".")) %>%
dplyr::ungroup(Site, Plot, Treatment, Month, Time, Species) %>%
mutate_all(replace_na, 0) %>%
codyn::community_structure(time.var=c("Site", "Plot", "Month", "Time"),
replicate.var = "Treatment",
abundance.var = "abundances",
metric = "SimpsonEvenness") %>% # for Simpson's evenness measure
mutate(life_form = rep("lianas")) %>%
unite(Site, Site, Treatment, Plot, Month, Time) %>% rename(PlotID = Site) %>%
dplyr::select(-3)
data.biota.rich.liana
View(data.biota.rich.liana)
View(data.biota.rich.tree)
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) #%>%
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) #%>%
data.biota.rich.tree <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "tree") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) #%>%
data.biota.rich.liana <- data_biota %>%
dplyr::select(-c(4, 24:26,28)) %>% # remove unused columns
gather(key = "Month", value = "value", 4:22) %>% # convert the information from columns 4 to 20 in the columns "time" (month data) and column "value", that contains the record of each individual
rename(life_form = `Life Form`) %>%
filter(life_form == "liana") %>%
dplyr::mutate(Time = as.numeric(Month %>% stringr::str_replace("T", ""))) #%>%
